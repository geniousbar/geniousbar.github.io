<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="initial-scale=1.0, user-scalable=no" name="viewport" /><title>thor option parse 的代替者 | 日常学习</title><meta description="thor     option parse 的代替者，可以在shell中调用脚本，更方便的传递参数，转换参数类型，　设定默认值，进行必要参数校验等.   简单的示例：  class Test &lt; Thor   desc "example FILE", "an example task"   method_option :delete, :aliases =&gt; "-d", :desc =&gt; "Delete the file after parsing it"   def example(file" /><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><link href="../../../../stylesheets/style-408849a5.css" rel="stylesheet" type="text/css" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" /><link href="../../../../images/favicon-6c3f3d04.png" rel="icon" type="image/png" /><script src="../../../../javascripts/all-ae915a3d.js"></script></head><body><header><div class="top-menu"><div class="top-menu-wrapper"><div class="top-menu-list"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li><li><a href="/by-year/">By Year</a></li></ul></div></div></div><h1 class="logo"><a href="/" title="日常学习"><span class="logo-text">日常学习</span></a></h1></header><main><article><h1 class="article-title">thor option parse 的代替者</h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">July 21, 2017</span></div><div class="tag-labels"><a href="/tags/ruby/"><small class="tag-label">ruby</small></a><a href="/tags/gem/"><small class="tag-label">gem</small></a></div><hr class="article-header-separator" /><h2 id="thor">thor</h2>

<blockquote>
  <p>option parse 的代替者，可以在shell中调用脚本，更方便的传递参数，转换参数类型，　设定默认值，进行必要参数校验等.</p>
</blockquote>

<h3 id="简单的示例">简单的示例：</h3>

<div class="highlight"><pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Test</span> <span class="o">&lt;</span> <span class="no">Thor</span>
  <span class="n">desc</span> <span class="s2">"example FILE"</span><span class="p">,</span> <span class="s2">"an example task"</span>
  <span class="n">method_option</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:aliases</span> <span class="o">=&gt;</span> <span class="s2">"-d"</span><span class="p">,</span> <span class="ss">:desc</span> <span class="o">=&gt;</span> <span class="s2">"Delete the file after parsing it"</span>
  <span class="k">def</span> <span class="nf">example</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="nb">puts</span> <span class="s2">"You supplied the file: </span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">delete_file</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="ss">:delete</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">delete_file</span>
      <span class="nb">puts</span> <span class="s2">"You specified that you would like to delete </span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">else</span>
      <span class="nb">puts</span> <span class="s2">"You do not want to delete </span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">thor</span> <span class="nb">test</span><span class="ss">:example</span> <span class="s1">'test.rb'</span> <span class="o">-</span><span class="n">d</span>

</code></pre></div><h4 id="method_options">method_options</h4>
<div class="highlight"><pre class="highlight plaintext"><code>aliases, type, desc, 描述参数的类型，简写形式
method_options :value, aliases: 'v', default: 1, type: :numeric
</code></pre></div>
<h4 id="invocations">invocations</h4>

<div class="highlight"><pre class="highlight plaintext"><code>```ruby class Counter &lt; Thor   desc "one", "Prints 1 2 3"   def one
puts 1
invoke :two
invoke :three   end
</code></pre></div>
<p>desc “two”, “Prints 2 3”<br />
  def two<br />
    puts 2<br />
    invoke :three<br />
  end</p>

<p>desc “three”, “Prints 3”<br />
  def three<br />
    puts 3<br />
  end<br />
end<br />
    ```</p>
<h4 id="executable">Executable</h4>

<div class="highlight"><pre class="highlight ruby"><code><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s2">"rubygems"</span> <span class="c1"># ruby1.9 doesn't "require" it though</span>
<span class="nb">require</span> <span class="s2">"thor"</span>

<span class="k">class</span> <span class="nc">MyThorCommand</span> <span class="o">&lt;</span> <span class="no">Thor</span>
  <span class="n">desc</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"Prints foo"</span>
  <span class="k">def</span> <span class="nf">foo</span>
    <span class="nb">puts</span> <span class="s2">"foo"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">MyThorCommand</span><span class="p">.</span><span class="nf">start</span>
</code></pre></div>
<blockquote>
  <p>最终要的是rails 中的generator使用thor创建，拷贝模板，　参数解析等</p>
</blockquote>
<div class="social"></div></article></main><footer><div class="footer-wrapper"><div class="author"><div class="image-wrapper"><a href="/author/"><img alt="author" src="../../../../images/profile-1e71686a.png" /></a></div></div><div class="copyright"><i class="fa fa-copyright"></i> 2017 <a href="/">日常学习</a> - geniousbar</div></div></footer></body></html>